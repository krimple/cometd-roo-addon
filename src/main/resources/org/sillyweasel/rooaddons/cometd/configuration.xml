<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<configuration>
    <maven>
        <dependencies>
            <dependency>
                <groupId>org.cometd.javascript</groupId>
                <artifactId>cometd-javascript-dojo</artifactId>
                <version>2.4.0</version>
                <type>war</type>
            </dependency>

            <dependency>
                <groupId>org.cometd.java</groupId>
                <artifactId>cometd-java-server</artifactId>
                <version>2.4.0</version>
            </dependency>

        </dependencies>
        <build>
            <plugins>
                <plugin>
                    <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-war-plugin</artifactId>
                    <version>2.1.1</version>
                    <configuration>
                        <overlays>
                            <overlay>
                                <groupId>org.cometd.javascript</groupId>
                                <artifactId>cometd-javascript-dojo</artifactId>
                                <excludes>
                                    <exclude>META-INF/**</exclude>
                                    <exclude>WEB-INF/**</exclude>
                                    <exclude>build-report.txt</exclude>
                                </excludes>
                                <targetPath>WEB-INF/classes/frameworks/dojo-toolkit</targetPath>
                            </overlay>
                        </overlays>
                    </configuration>
                </plugin>
            </plugins>
        </build>
    </maven>
    <webxml>
        <servlet>
            <servlet-name>cometd</servlet-name>
            <servlet-class>org.cometd.server.CometdServlet</servlet-class>
            <async-supported>true</async-supported>
            <init-param>
                <param-name>timeout</param-name>
                <param-value>60000</param-value>
            </init-param>
            <init-param>
                <param-name>logLevel</param-name>
                <param-value>3</param-value>
            </init-param>
        </servlet>
        <servlet-mapping>
            <servlet-name>cometd</servlet-name>
            <url-pattern>/cometd/*</url-pattern>
        </servlet-mapping>
        <filter>
            <filter-name>cross-origin</filter-name>
            <filter-class>org.eclipse.jetty.servlets.CrossOriginFilter</filter-class>
            <async-supported>true</async-supported>
        </filter>
        <filter-mapping>
            <filter-name>cross-origin</filter-name>
            <url-pattern>/cometd/*</url-pattern>
        </filter-mapping>
    </webxml>
</configuration>